#!/bin/bash
#SBATCH --job-name=r_setup
#SBATCH --ntasks-per-node=1
#SBATCH --mem=16G
#SBATCH --partition=imag
#SBATCH --time=01:00:00
#SBATCH --output=%x_%j.out

# --- Exports pour curl local + sf ---
export LD_LIBRARY_PATH=$HOME/local/curl/lib:$HOME/local/udunits2/lib:/trinity/shared/apps/local/proj/7.2.1/lib:/trinity/shared/apps/local/gdal/3.4.2/lib:/trinity/shared/apps/local/geos/3.7.2/lib:$LD_LIBRARY_PATH
export PKG_CONFIG_PATH=$HOME/local/curl/lib/pkgconfig:$HOME/local/udunits2/lib/pkgconfig:$PKG_CONFIG_PATH
export PATH=$HOME/local/curl/bin:$PATH

# --- Charger les modules système ---
module load R
module load geos
module load gdal

# --- Chemin de travail ---
WORK_DIR="/home/serrec/work_rainstsimu/rpareto"

# --- Script R inline ---
Rscript - <<'EOF'
# Charger curl et devtools
library(curl)
library(sf)

# Vérifier la version des libs externes pour sf (si sf est utilisé)
if (requireNamespace("sf", quietly = TRUE)) {
  print(sf::sf_extSoftVersion())
}
EOF

